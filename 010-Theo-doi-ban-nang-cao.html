<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Affiliate Tracker</title>

<style>
body{font-family:Arial;background:#f4f6fa;padding:10px}
h2{margin-top:0}
input,select,button{padding:6px;margin:4px}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border:1px solid #ccc;padding:6px;text-align:center}
.good{background:#c8f7c5}
.bad{background:#f7c5c5}
.summary{margin-top:15px;background:#fff;padding:10px;border-radius:6px}
</style>
</head>

<body>

<h2>ğŸ“Š Theo dÃµi Affiliate Shopee</h2>

<!-- FORM NHáº¬P -->
<div>
<input type="date" id="date">
<select id="platform">
  <option>Facebook</option>
  <option>Zalo</option>
</select>
<input type="text" id="post" placeholder="TÃªn bÃ i">
<input type="text" id="subid" placeholder="Sub ID">
<input type="number" id="click" placeholder="Click">
<input type="number" id="order" placeholder="ÄÆ¡n">
<input type="number" id="commission" placeholder="Hoa há»“ng">
<button onclick="addRow()">â• ThÃªm</button>
<button onclick="exportCSV()">â¬‡ Xuáº¥t Excel</button>
</div>

<!-- Báº¢NG -->
<table id="table">
<tr>
<th>NgÃ y</th>
<th>Ná»n táº£ng</th>
<th>BÃ i</th>
<th>Sub ID</th>
<th>Click</th>
<th>ÄÆ¡n</th>
<th>Hoa há»“ng</th>
<th>Tráº¡ng thÃ¡i</th>
</tr>
</table>

<!-- THá»NG KÃŠ -->
<div class="summary">
<h3>ğŸ“ˆ Thá»‘ng kÃª</h3>
<p>Tá»•ng click: <span id="tClick">0</span></p>
<p>Tá»•ng Ä‘Æ¡n: <span id="tOrder">0</span></p>
<p>Tá»•ng hoa há»“ng: <span id="tMoney">0</span> Ä‘</p>
</div>

<script>
let data = JSON.parse(localStorage.getItem("affiliate")) || [];

function addRow(){
  let item = {
    date: date.value,
    platform: platform.value,
    post: post.value,
    subid: subid.value,
    click: +click.value,
    order: +order.value,
    commission: +commission.value
  };
  data.push(item);
  localStorage.setItem("affiliate",JSON.stringify(data));
  render();
}

function render(){
  let table = document.getElementById("table");
  table.innerHTML = table.rows[0].outerHTML;

  let tC=0,tO=0,tM=0;

  data.forEach(d=>{
    let status = (d.order>0) ? "GIá»®" : (d.click>=30 ? "Bá»" : "THEO DÃ•I");
    let cls = status=="GIá»®"?"good":status=="Bá»"?"bad":"";

    table.innerHTML += `
    <tr class="${cls}">
    <td>${d.date}</td>
    <td>${d.platform}</td>
    <td>${d.post}</td>
    <td>${d.subid}</td>
    <td>${d.click}</td>
    <td>${d.order}</td>
    <td>${d.commission}</td>
    <td>${status}</td>
    </tr>`;

    tC+=d.click; tO+=d.order; tM+=d.commission;
  });

  tClick.innerText=tC;
  tOrder.innerText=tO;
  tMoney.innerText=tM.toLocaleString();
}

function exportCSV(){
  let csv="NgÃ y,Ná»n táº£ng,BÃ i,Sub ID,Click,ÄÆ¡n,Hoa há»“ng\n";
  data.forEach(d=>{
    csv+=`${d.date},${d.platform},${d.post},${d.subid},${d.click},${d.order},${d.commission}\n`;
  });
  let blob=new Blob([csv],{type:"text/csv"});
  let a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="affiliate-report.csv";
  a.click();
}

render();
</script>

</body>
</html>
