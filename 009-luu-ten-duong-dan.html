<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ªá Th·ªëng N·ªôi Dung & Affiliate - Pro Hub</title>
    <style>
        :root {
            --primary: #6a11cb; --secondary: #2575fc; --success: #2ecc71;
            --warning: #f1c40f; --danger: #e74c3c; --light: #f8f9fa; --dark: #2c3e50;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background: #f0f2f5; color: #333; min-height: 100vh; padding: 20px; }
        .container { max-width: 1300px; margin: 0 auto; }
        .header {
            text-align: center; margin-bottom: 30px; padding: 25px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border-radius: 15px; color: white; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .section-title { margin: 30px 0 15px; padding-left: 10px; border-left: 5px solid var(--primary); color: var(--dark); font-size: 1.5rem; }
        .main-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; margin-bottom: 30px; }
        .card { background: white; border-radius: 12px; padding: 15px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05); transition: 0.3s; border-top: 4px solid var(--secondary); }
        textarea, input[type="text"], input[type="number"] { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; margin-bottom: 10px; font-size: 14px; }
        .btn { padding: 8px 12px; border: none; border-radius: 5px; font-weight: 600; cursor: pointer; font-size: 12px; color: white; display: inline-flex; align-items: center; gap: 5px; margin-top: 5px; }
        .btn-blue { background: var(--secondary); } .btn-red { background: var(--danger); } .btn-green { background: var(--success); }
        .result-box { background: var(--light); border-radius: 6px; padding: 10px; margin-top: 10px; max-height: 200px; overflow-y: auto; border: 1px solid #eee; font-size: 13px; white-space: pre-wrap; }
        table { border-collapse: collapse; width: 100%; margin-top: 10px; background: white; border-radius: 12px; overflow: hidden; }
        th, td { border: 1px solid #eee; padding: 10px; text-align: center; font-size: 14px; }
        th { background: var(--light); color: var(--dark); }
        .good { background: #e8f5e9; color: #2e7d32; font-weight: bold; }
        .status-tag { padding: 3px 8px; border-radius: 4px; font-size: 11px; font-weight: bold; color: white; }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>

<div class="container">
    <div class="header">
        <h1><i class="fas fa-rocket"></i> Tr·∫°m Trung Chuy·ªÉn Affiliate Nam Nguy·ªÖn</h1>
        <p>G·∫Øn link v√†o truy·ªán - L∆∞u kho GitHub - ƒê·∫©y d·ªØ li·ªáu Google Sheet</p>
    </div>

    <h2 class="section-title">1. Quy tr√¨nh X·ª≠ l√Ω n·ªôi dung (006 + 012)</h2>
    <div class="main-grid">
        <div class="card" style="grid-column: span 1;">
            <h3><i class="fas fa-edit"></i> B∆∞·ªõc 1: So·∫°n th·∫£o</h3>
            <textarea id="inputText" rows="6" placeholder="D√°n n·ªôi dung truy·ªán v√†o ƒë√¢y...">Ti·∫øng Vi·ªát l√† ng√¥n ng·ªØ tuy·ªát v·ªùi.</textarea>
            <input type="text" id="shortLink" placeholder="D√°n Link R√∫t G·ªçn Shopee t·∫°i ƒë√¢y...">
            <input type="text" id="prodTitle" placeholder="T√™n s·∫£n ph·∫©m (V√≠ d·ª•: Tr√† d∆∞·ª°ng nhan)">
            <button class="btn btn-blue" onclick="processPost()"><i class="fas fa-magic"></i> G·∫ÆN LINK & PH√ÇN T√çCH</button>
        </div>

        <div class="card">
            <h3><i class="fas fa-copy"></i> B∆∞·ªõc 2: B√†i ƒëƒÉng ho√†n ch·ªânh</h3>
            <div class="result-box" id="finalStoryResult">N·ªôi dung ƒë√£ g·∫Øn link s·∫Ω hi·ªán ·ªü ƒë√¢y...</div>
            <button class="btn btn-green" onclick="copyText('finalStoryResult')"><i class="fas fa-clipboard"></i> COPY B√ÄI ƒêƒÇNG</button>
        </div>

        <div class="card">
            <h3><i class="fas fa-table"></i> B∆∞·ªõc 3: D√≤ng Google Sheet</h3>
            <div class="result-box" id="sheetRowResult">D√≤ng d·ªØ li·ªáu cho Sheet...</div>
            <button class="btn btn-blue" onclick="copyText('sheetRowResult')"><i class="fas fa-file-export"></i> COPY D√íNG SHEET</button>
        </div>

        <div class="card">
            <h3><i class="fas fa-code"></i> B∆∞·ªõc 4: JSON GitHub</h3>
            <div class="result-box" id="jsonResult">D√≤ng d·ªØ li·ªáu cho files.json...</div>
            <button class="btn btn-red" onclick="saveToHistory()"><i class="fas fa-save"></i> L∆ØU V√ÄO L·ªäCH S·ª¨</button>
        </div>
    </div>

    <h2 class="section-title">2. L·ªãch s·ª≠ & Kho l∆∞u tr·ªØ (009)</h2>
    <div style="overflow-x: auto;">
        <table id="historyTable">
            <thead>
                <tr>
                    <th>Ng√†y</th>
                    <th>S·∫£n ph·∫©m</th>
                    <th>Link R√∫t G·ªçn</th>
                    <th>SubID</th>
                    <th>H√†nh ƒë·ªông</th>
                </tr>
            </thead>
            <tbody id="historyBody">
                </tbody>
        </table>
    </div>
</div>

<script>
    const accentMap = {'ƒÇ':'A','√Ç':'A','ƒê':'D','√ä':'E','√î':'O','∆†':'O','∆Ø':'U','ƒÉ':'a','√¢':'a','ƒë':'d','√™':'e','√¥':'o','∆°':'o','∆∞':'u','√Ä':'A','√Å':'A','·∫¢':'A','√É':'A','·∫†':'A','·∫∞':'A','·∫Æ':'A','·∫≤':'A','·∫¥':'A','·∫∂':'A','·∫¶':'A','·∫§':'A','·∫®':'A','·∫™':'A','·∫¨':'A','√à':'E','√â':'E','·∫∫':'E','·∫º':'E','·∫∏':'E','·ªÄ':'E','·∫æ':'E','·ªÇ':'E','·ªÑ':'E','·ªÜ':'E','√å':'I','√ç':'I','·ªà':'I','ƒ®':'I','·ªä':'I','√í':'O','√ì':'O','·ªé':'O','√ï':'O','·ªå':'O','·ªí':'O','·ªê':'O','·ªî':'O','·ªñ':'O','·ªò':'O','·ªú':'O','·ªö':'O','·ªû':'O','·ª†':'O','·ª¢':'O','√ô':'U','√ö':'U','·ª¶':'U','≈®':'U','·ª§':'U','·ª™':'U','·ª®':'U','·ª¨':'U','·ªÆ':'U','·ª∞':'U','·ª≤':'Y','√ù':'Y','·ª∂':'Y','·ª∏':'Y','·ª¥':'Y','√†':'a','√°':'a','·∫£':'a','√£':'a','·∫°':'a','·∫±':'a','·∫Ø':'a','·∫≥':'a','·∫µ':'a','·∫∑':'a','·∫ß':'a','·∫•':'a','·∫©':'a','·∫´':'a','·∫≠':'a','√®':'e','√©':'e','·∫ª':'e','·∫Ω':'e','·∫π':'e','·ªÅ':'e','·∫ø':'e','·ªÉ':'e','·ªÖ':'e','·ªá':'e','√¨':'i','√≠':'i','·ªâ':'i','ƒ©':'i','·ªã':'i','√≤':'o','√≥':'o','·ªè':'o','√µ':'o','·ªç':'o','·ªì':'o','·ªë':'o','·ªï':'o','·ªó':'o','·ªô':'o','·ªù':'o','·ªõ':'o','·ªü':'o','·ª°':'o','·ª£':'o','√π':'u','√∫':'u','·ªß':'u','≈©':'u','·ª•':'u','·ª´':'u','·ª©':'u','·ª≠':'u','·ªØ':'u','·ª±':'u','·ª≥':'y','√Ω':'y','·ª∑':'y','·ªπ':'y','·ªµ':'y'};

    function removeAccents(str) { return str.split('').map(char => accentMap[char] || char).join(''); }

    function processPost() {
        const text = document.getElementById('inputText').value;
        const link = document.getElementById('shortLink').value;
        const title = document.getElementById('prodTitle').value || "S·∫£n ph·∫©m";
        const date = new Date().toLocaleDateString('vi-VN');

        if (!link) { alert("Vui l√≤ng nh·∫≠p link r√∫t g·ªçn!"); return; }

        // 1. G·∫Øn link v√†o b√†i
        const finalStory = text + "\n\nüëâ SƒÉn ngay t·∫°i ƒë√¢y nh√©: " + link;
        document.getElementById('finalStoryResult').innerText = finalStory;

        // 2. G·ª£i √Ω SubID (L·∫•y 3 k√Ω t·ª± cu·ªëi c·ªßa 3 t·ª´ ng·∫´u nhi√™n)
        const noAccent = removeAccents(text);
        const words = noAccent.split(/\s+/).filter(w => w.length > 2);
        const subId = "WEB_" + new Date().getDate() + "_" + words.slice(-3).map(w => w.slice(-1).toUpperCase()).join('');

        // 3. T·∫°o d√≤ng Google Sheet
        const sheetRow = `${date}\t${title}\t${link}\t${subId}`;
        document.getElementById('sheetRowResult').innerText = sheetRow;

        // 4. T·∫°o d√≤ng JSON
        const jsonLine = { date, title, link, subId };
        document.getElementById('jsonResult').innerText = JSON.stringify(jsonLine);
    }

    function saveToHistory() {
        const jsonStr = document.getElementById('jsonResult').innerText;
        if (jsonStr.startsWith('{')) {
            const data = JSON.parse(jsonStr);
            const body = document.getElementById('historyBody');
            const newRow = `<tr class="good">
                <td>${data.date}</td>
                <td>${data.title}</td>
                <td>${data.link}</td>
                <td><code>${data.subId}</code></td>
                <td><button class="btn btn-red" onclick="this.parentElement.parentElement.remove()">X√≥a</button></td>
            </tr>`;
            body.innerHTML = newRow + body.innerHTML;
            alert("ƒê√£ l∆∞u v√†o l·ªãch s·ª≠ t·∫°m th·ªùi!");
        }
    }

    function copyText(id) {
        const text = document.getElementById(id).innerText;
        navigator.clipboard.writeText(text);
        alert("ƒê√£ copy th√†nh c√¥ng!");
    }
</script>
</body>
</html>
