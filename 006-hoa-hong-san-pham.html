<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phân Tích Văn Bản Tiếng Việt - Pro Version</title>
    <style>
        :root {
            --primary: #6a11cb;
            --secondary: #2575fc;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
            --light: #f8f9fa;
            --dark: #2c3e50;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }

        body {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: #333; min-height: 100vh; padding: 20px;
        }

        .container { max-width: 1200px; margin: 0 auto; }

        .header {
            text-align: center; margin-bottom: 30px; padding: 25px;
            background: rgba(255, 255, 255, 0.1); border-radius: 15px;
            backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
        }

        .main-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px; margin-bottom: 30px;
        }

        .card {
            background: white; border-radius: 15px; padding: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            transition: 0.3s; border-top: 5px solid var(--secondary);
        }

        .card:hover { transform: translateY(-5px); }
        .card h2 { font-size: 1.2rem; color: var(--dark); margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }

        textarea, input[type="text"] {
            width: 100%; padding: 12px; border: 2px solid #eee;
            border-radius: 8px; font-size: 14px; margin-bottom: 10px;
        }

        .button-group { display: flex; gap: 8px; flex-wrap: wrap; }

        button {
            padding: 10px 15px; border: none; border-radius: 6px;
            font-weight: 600; cursor: pointer; transition: 0.2s;
            font-size: 13px; color: white; display: flex; align-items: center; gap: 5px;
        }

        .btn-blue { background: var(--secondary); }
        .btn-green { background: var(--success); }
        .btn-red { background: var(--danger); }
        .btn-purple { background: #9b59b6; }

        .result-box {
            background: var(--light); border-radius: 8px; padding: 12px;
            margin-top: 15px; max-height: 250px; overflow-y: auto;
            border: 1px solid #ddd; font-size: 13px; line-height: 1.6;
        }

        .highlight { background: #fff3cd; color: #856404; font-weight: bold; padding: 0 3px; }

        .footer { text-align: center; color: white; margin-top: 20px; opacity: 0.8; }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-microchip"></i> Hệ Thống Phân Tích Việt Ngữ</h1>
            <p>Xử lý câu, từ, hoán vị và ký tự cuối dòng</p>
        </div>

        <div class="main-grid">
            <div class="card">
                <h2><i class="fas fa-edit"></i> Ô 1: Văn bản nguồn</h2>
                <textarea id="inputText" rows="5" placeholder="Nhập nội dung cần xử lý...">Tiếng Việt là ngôn ngữ của người Việt và là ngôn ngữ chính thức tại Việt Nam. Đây là tiếng mẹ đẻ của khoảng 85% dân cư.</textarea>
                <div class="button-group">
                    <button class="btn-red" onclick="document.getElementById('inputText').value=''"><i class="fas fa-eraser"></i> Xóa</button>
                </div>
            </div>

            <div class="card">
                <h2><i class="fas fa-keyboard"></i> Ô 2: Chữ cái mục tiêu</h2>
                <input type="text" id="searchChars" value="A Ă Â" placeholder="Ví dụ: A B C">
                <div class="button-group">
                    <button class="btn-purple" onclick="generatePermutations()"><i class="fas fa-sync"></i> Tạo hoán vị</button>
                </div>
                <div class="result-box" id="permutationResult"></div>
            </div>

            <div class="card">
                <h2><i class="fas fa-stream"></i> Ô 3: Cấu trúc câu</h2>
                <button class="btn-blue" onclick="analyzeText()"><i class="fas fa-search"></i> Phân tích</button>
                <div class="result-box" id="analysisResult"></div>
            </div>

            <div class="card">
                <h2><i class="fas fa-italic"></i> Ô 4: Chữ cuối (Gốc)</h2>
                <button class="btn-green" onclick="findLastLetters()"><i class="fas fa-filter"></i> Lọc chữ cuối</button>
                <div class="result-box" id="lastLettersResult"></div>
            </div>

            <div class="card">
                <h2><i class="fas fa-font"></i> Ô 5: Khử dấu (Ô 2)</h2>
                <button class="btn-purple" onclick="convertToNoAccent()"><i class="fas fa-magic"></i> Chuyển đổi</button>
                <div class="result-box" id="noAccentResult"></div>
            </div>

            <div class="card">
                <h2><i class="fas fa-random"></i> Ô 6: Hoán vị (Không dấu)</h2>
                <button class="btn-purple" onclick="generateNoAccentPermutations()"><i class="fas fa-random"></i> Tạo nhanh</button>
                <div class="result-box" id="noAccentPermutationResult"></div>
            </div>

            <div class="card">
                <h2><i class="fas fa-spell-check"></i> Ô 7: Chữ cuối (Không dấu)</h2>
                <button class="btn-green" onclick="findLastLettersNoAccent()"><i class="fas fa-check-circle"></i> Kiểm tra</button>
                <div class="result-box" id="lastLettersNoAccentResult"></div>
            </div>
        </div>

        <div class="footer">
            <p>© 2026 Hệ Thống Phân Tích Thông Minh - Gemini Flash 3</p>
        </div>
    </div>

    <script>
        // Bảng mã chuyển đổi
        const accentMap = {'Ă':'A','Â':'A','Đ':'D','Ê':'E','Ô':'O','Ơ':'O','Ư':'U','ă':'a','â':'a','đ':'d','ê':'e','ô':'o','ơ':'o','ư':'u','À':'A','Á':'A','Ả':'A','Ã':'A','Ạ':'A','Ằ':'A','Ắ':'A','Ẳ':'A','Ẵ':'A','Ặ':'A','Ầ':'A','Ấ':'A','Ẩ':'A','Ẫ':'A','Ậ':'A','È':'E','É':'E','Ẻ':'E','Ẽ':'E','Ẹ':'E','Ề':'E','Ế':'E','Ể':'E','Ễ':'E','Ệ':'E','Ì':'I','Í':'I','Ỉ':'I','Ĩ':'I','Ị':'I','Ò':'O','Ó':'O','Ỏ':'O','Õ':'O','Ọ':'O','Ồ':'O','Ố':'O','Ổ':'O','Ỗ':'O','Ộ':'O','Ờ':'O','Ớ':'O','Ở':'O','Ỡ':'O','Ợ':'O','Ù':'U','Ú':'U','Ủ':'U','Ũ':'U','Ụ':'U','Ừ':'U','Ứ':'U','Ử':'U','Ữ':'U','Ự':'U','Ỳ':'Y','Ý':'Y','Ỷ':'Y','Ỹ':'Y','Ỵ':'Y','à':'a','á':'a','ả':'a','ã':'a','ạ':'a','ằ':'a','ắ':'a','ẳ':'a','ẵ':'a','ặ':'a','ầ':'a','ấ':'a','ẩ':'a','ẫ':'a','ậ':'a','è':'e','é':'e','ẻ':'e','ẽ':'e','ẹ':'e','ề':'e','ế':'e','ể':'e','ễ':'e','ệ':'e','ì':'i','í':'i','ỉ':'i','ĩ':'i','ị':'i','ò':'o','ó':'o','ỏ':'o','õ':'o','ọ':'o','ồ':'o','ố':'o','ổ':'o','ỗ':'o','ộ':'o','ờ':'o','ớ':'o','ở':'o','ỡ':'o','ợ':'o','ù':'u','ú':'u','ủ':'u','ũ':'u','ụ':'u','ừ':'u','ứ':'u','ử':'u','ữ':'u','ự':'u','ỳ':'y','ý':'y','ỷ':'y','ỹ':'y','ỵ':'y'};

        function removeAccents(str) {
            return str.split('').map(char => accentMap[char] || char).join('');
        }

        function getPermutations(arr) {
            if (arr.length <= 1) return [arr];
            const result = [];
            for (let i = 0; i < arr.length; i++) {
                const char = arr[i];
                const remainingChars = arr.slice(0, i).concat(arr.slice(i + 1));
                const innerPermutations = getPermutations(remainingChars);
                for (let j = 0; j < innerPermutations.length; j++) {
                    result.push([char].concat(innerPermutations[j]));
                }
            }
            return result;
        }

        function generatePermutations() {
            const chars = document.getElementById('searchChars').value.split(/\s+/).filter(c => c);
            const perms = getPermutations(chars.slice(0, 3));
            document.getElementById('permutationResult').innerHTML = perms.map(p => p.join(' ')).join('<br>');
        }

        function analyzeText() {
            const text = document.getElementById('inputText').value;
            const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 30 || s.trim().split(/\s+/).length > 10);
            document.getElementById('analysisResult').innerHTML = sentences.length ? 
                sentences.map((s, i) => `<b>Câu ${i+1}:</b> ${s.trim()}`).join('<hr>') : "Không có câu nào đủ độ dài.";
        }

        function findLastLetters() {
            const text = document.getElementById('inputText').value;
            const target = document.getElementById('searchChars').value.split(/\s+/).filter(c => c);
            const lines = text.split('\n');
            let html = "";
            lines.forEach((line, idx) => {
                const words = line.trim().split(/\s+/);
                const lasts = words.map(w => w.replace(/[.,!?;]/g, '').slice(-1));
                const matches = lasts.filter(l => target.includes(l));
                if (matches.length >= 3) {
                    html += `Line ${idx+1}: Found ${matches.length} matches [${matches.join(',')}]<br>`;
                }
            });
            document.getElementById('lastLettersResult').innerHTML = html || "Không tìm thấy dòng khớp.";
        }

        function convertToNoAccent() {
            const val = document.getElementById('searchChars').value;
            document.getElementById('noAccentResult').innerText = removeAccents(val);
        }

        function generateNoAccentPermutations() {
            const chars = removeAccents(document.getElementById('searchChars').value).split(/\s+/).filter(c => c);
            const perms = getPermutations(chars.slice(0, 3));
            document.getElementById('noAccentPermutationResult').innerHTML = perms.map(p => p.join(' ')).join('<br>');
        }

        function findLastLettersNoAccent() {
            const text = removeAccents(document.getElementById('inputText').value);
            const target = removeAccents(document.getElementById('searchChars').value).split(/\s+/).filter(c => c);
            const lines = text.split('\n');
            let html = "";
            lines.forEach((line, idx) => {
                const words = line.trim().split(/\s+/);
                const lasts = words.map(w => w.replace(/[.,!?;]/g, '').slice(-1));
                const matches = lasts.filter(l => target.includes(l));
                if (matches.length >= 3) {
                    html += `Dòng ${idx+1}: Khớp ${matches.length} chữ không dấu [${matches.join(',')}]<br>`;
                }
            });
            document.getElementById('lastLettersNoAccentResult').innerHTML = html || "Không tìm thấy.";
        }
    </script>
</body>
</html>
