<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Affiliate Hub Pro – Quản lý & Nhật ký</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
/* Giữ nguyên phần CSS của bạn vì nó rất đẹp và chuyên nghiệp */
:root {
  --primary: #2563eb; --primary-dark: #1d4ed8; --secondary: #0f766e;
  --light: #f8fafc; --dark: #1e293b; --gray: #64748b;
  --gray-light: #e2e8f0; --success: #10b981; --warning: #f59e0b;
  --danger: #ef4444; --radius: 12px; --transition: all 0.3s ease;
  --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); color: var(--dark); padding: 20px; min-height: 100vh; }
.container { max-width: 1400px; margin: 0 auto; }
header { text-align: center; margin-bottom: 30px; padding: 20px; background: white; border-radius: var(--radius); box-shadow: var(--shadow); }
header h1 { color: var(--primary); font-size: 2.2rem; display: flex; align-items: center; justify-content: center; gap: 15px; }
.main-content { display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 30px; }
.panel { background: white; border-radius: var(--radius); box-shadow: var(--shadow); padding: 20px; }
.panel-title { display: flex; align-items: center; gap: 10px; color: var(--primary); margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid var(--gray-light); font-size: 1.3rem; }
.file-list { flex: 1; min-width: 320px; max-height: 80vh; overflow-y: auto; }
.file-item { padding: 12px 15px; border-radius: 8px; text-decoration: none; color: var(--dark); background: var(--light); border-left: 4px solid var(--gray); transition: var(--transition); display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; cursor: pointer; }
.file-item:hover { background: #f1f5f9; transform: translateX(5px); }
.file-item.active { background: var(--primary); color: white; border-left-color: var(--primary-dark); }
.file-item.done { background: #dcfce7; border-left-color: var(--success); }
.viewer { flex: 2; min-width: 400px; display: flex; flex-direction: column; min-height: 80vh; }
.viewer-controls { display: flex; justify-content: space-between; margin-bottom: 15px; gap: 10px; }
.viewer-frame { flex: 1; border-radius: 8px; overflow: hidden; border: 1px solid var(--gray-light); background: white; height: 600px; }
iframe { width: 100%; height: 100%; border: none; }
.diary { flex: 1; min-width: 320px; max-height: 80vh; overflow-y: auto; }
.form-control { width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid var(--gray-light); border-radius: 8px; }
.btn { padding: 10px 15px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 8px; transition: 0.2s; }
.btn-primary { background: var(--primary); color: white; width: 100%; justify-content: center; }
.btn-success { background: var(--success); color: white; }
.btn-outline { border: 1px solid var(--primary); color: var(--primary); background: white; }
.log-entry { padding: 12px; border-radius: 8px; background: #f8fafc; border-left: 4px solid var(--primary); margin-bottom: 10px; font-size: 0.9rem; }
.progress-container { background: white; border-radius: var(--radius); padding: 20px; box-shadow: var(--shadow); }
.progress-bar { height: 12px; background: var(--gray-light); border-radius: 6px; overflow: hidden; margin: 10px 0; }
.progress-fill { height: 100%; background: var(--success); transition: 0.5s; }
@media (max-width: 1000px) { .main-content { flex-direction: column; } }
</style>
</head>

<body>
<div class="container">
  <header>
    <h1><i class="fas fa-rocket"></i> AFFILIATE HUB PRO</h1>
    <p class="subtitle">Hệ thống làm việc tuần tự & Nhật ký vận hành</p>
  </header>

  <div class="main-content">
    <div class="panel file-list">
      <div class="panel-title"><i class="fas fa-list-ol"></i> <span>Lộ trình làm việc</span></div>
      <div class="file-list-container" id="list"></div>
    </div>

    <div class="panel viewer">
      <div class="viewer-controls">
        <button class="btn btn-outline" onclick="prev()"><i class="fas fa-arrow-left"></i> Trước</button>
        <button class="btn btn-success" onclick="markDone()"><i class="fas fa-check"></i> Xong</button>
        <button class="btn btn-outline" onclick="next()">Sau <i class="fas fa-arrow-right"></i></button>
      </div>
      <div class="viewer-frame">
        <iframe id="frame" name="viewer_frame"></iframe>
      </div>
    </div>

    <div class="panel diary">
      <div class="panel-title"><i class="fas fa-pen-nib"></i> <span>Nhật ký đăng bài</span></div>
      <form onsubmit="event.preventDefault(); saveLog();">
        <input type="datetime-local" id="time" class="form-control">
        <select id="platform" class="form-control">
          <option>Facebook</option><option>Zale</option><option>TikTok</option>
          <option>Shopee Video</option><option>Group FB</option>
        </select>
        <input id="product" class="form-control" placeholder="Tên sản phẩm/Link...">
        <textarea id="note" class="form-control" placeholder="Ghi chú kết quả..."></textarea>
        <button type="submit" class="btn btn-primary">Lưu nhật ký</button>
      </form>
      <hr style="margin: 20px 0; opacity: 0.2;">
      <div id="logs"></div>
    </div>
  </div>

  <div class="progress-container">
    <div style="display: flex; justify-content: space-between;">
      <span>Tiến độ hoàn thành: <b id="progress-percent">0%</b></span>
      <span id="progress-text">0/0 tài liệu</span>
    </div>
    <div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div>
  </div>
</div>

<script>
// DANH SÁCH FILE ĐÃ CẬP NHẬT THEO GITHUB CỦA BẠN
  const files = [
  "000-affiliate-hub.html",
  "001-chon-nguoi-mo-hang.html",
  "002-huong-dan-lam-tiep-thi.html",
  "003-thoi-gian-bieu-gio-dang.html",
  "004-hoa-hong shope.html",
  "005-hoa-hong-extra.html",
  "006-hoa-hong-san-pham.html",
  "009-luu-ten-duong-dan.html",
  "012-Quan-ly-link.html",
  "013-Quan-ly-Kim-tu-do.html",
  "014-thong-ke-nguoi-giup-ban-hang.html",
  "015-ban-do-tac-chien.html" 
];

let index = +localStorage.getItem("current_v2") || 0;
let done = JSON.parse(localStorage.getItem("done_v2") || "[]");
let logs = JSON.parse(localStorage.getItem("logs_v2") || "[]");

// Cập nhật thời gian mặc định
document.getElementById('time').value = new Date().toISOString().slice(0, 16);

function renderList() {
  const list = document.getElementById("list");
  list.innerHTML = "";
  
  files.forEach((file, i) => {
    const item = document.createElement("div");
    item.className = `file-item ${i === index ? 'active' : ''} ${done.includes(i) ? 'done' : ''}`;
    
    // Làm sạch tên hiển thị: Bỏ số thứ tự và .html
    const cleanName = file.replace(/^\d+-/, '').replace('.html', '').replace(/-/g, ' ');
    
    item.innerHTML = `
      <span><b>${file.split('-')[0]}</b>. ${cleanName}</span>
      <i class="fas ${done.includes(i) ? 'fa-check-circle' : 'fa-circle'}" style="font-size: 0.8rem; opacity: 0.5;"></i>
    `;
    item.onclick = () => openFile(i);
    list.appendChild(item);
  });
  updateProgress();
}

function openFile(i) {
  if(i < 0 || i >= files.length) return;
  index = i;
  document.getElementById("frame").src = files[i];
  localStorage.setItem("current_v2", i);
  renderList();
}

function next() { openFile(index + 1); }
function prev() { openFile(index - 1); }

function markDone() {
  if (!done.includes(index)) {
    done.push(index);
    localStorage.setItem("done_v2", JSON.stringify(done));
    renderList();
    setTimeout(next, 500); // Tự động sang bài tiếp theo sau khi đánh dấu
  }
}

function updateProgress() {
  const percentage = Math.round((done.length / files.length) * 100);
  document.getElementById("progress-percent").textContent = percentage + "%";
  document.getElementById("progress-fill").style.width = percentage + "%";
  document.getElementById("progress-text").textContent = `Đã xong ${done.length}/${files.length}`;
}

function saveLog() {
  const log = {
    time: document.getElementById("time").value,
    platform: document.getElementById("platform").value,
    product: document.getElementById("product").value,
    note: document.getElementById("note").value
  };
  if(!log.product) return alert("Nhập tên SP!");
  
  logs.unshift(log);
  localStorage.setItem("logs_v2", JSON.stringify(logs));
  renderLogs();
  
  // Reset form
  document.getElementById("product").value = "";
  document.getElementById("note").value = "";
}

function renderLogs() {
  const container = document.getElementById("logs");
  container.innerHTML = logs.map(l => `
    <div class="log-entry">
      <div style="display:flex; justify-content:space-between; margin-bottom:5px">
        <b style="color:var(--primary)">${l.platform}</b>
        <small>${new Date(l.time).toLocaleString('vi-VN')}</small>
      </div>
      <div>${l.product}</div>
      <div style="font-size:0.8rem; color:var(--gray)">${l.note}</div>
    </div>
  `).join('');
}

// Khởi chạy
renderList();
openFile(index);
renderLogs();
</script>
</body>
</html>
