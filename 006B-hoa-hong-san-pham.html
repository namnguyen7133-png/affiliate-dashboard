<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C√¥ng C·ª• L·ªçc S·∫£n Ph·∫©m Shopee - Nam Nguy·ªÖn</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; padding: 20px; background: #f4f4f9; line-height: 1.6; }
        .box { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); max-width: 600px; margin: 0 auto; }
        h2 { color: #ee4d2d; text-align: center; }
        .input-group { margin-bottom: 15px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; }
        button { width: 100%; background: #ee4d2d; color: white; border: none; padding: 12px; border-radius: 6px; font-weight: bold; cursor: pointer; font-size: 16px; }
        button:hover { background: #d73d1d; }
        #result { margin-top: 20px; white-space: pre-wrap; background: #eee; padding: 15px; border-radius: 8px; font-size: 13px; display: none; }
    </style>
</head>
<body>

<div class="box">
    <h2>üöÄ B·ªô L·ªçc Kim T·ª© ƒê·ªì</h2>
    
    <div class="input-group">
        <label>1. Ch·ªçn t·ªáp CSV (Xu·∫•t t·ª´ Google Sheets):</label>
        <input type="file" id="csvFile" accept=".csv">
    </div>

    <div class="input-group">
        <label>2. L·ªçc theo s·ªë l∆∞·ª£ng b√°n (k):</label>
        <input type="text" id="salesFilter" value="22, 30, 32, 40, 42" placeholder="V√≠ d·ª•: 22, 32, 40">
        <small style="color: #666;">*S·∫Ω l·ªçc c√°c s·∫£n ph·∫©m c√≥ s·ªë b√°n ch√≠nh x√°c c√°c m·ª©c n√†y.</small>
    </div>

    <div class="input-group">
        <label>3. Nh·∫≠p % Hoa h·ªìng t·ªëi thi·ªÉu (%):</label>
        <input type="number" id="commFilter" value="7">
    </div>

    <button onclick="processData()">L·ªåC S·∫¢N PH·∫®M NGAY</button>

    <div id="result"></div>
</div>

<script>
    function processData() {
        const fileInput = document.getElementById('csvFile');
        const salesTarget = document.getElementById('salesFilter').value.split(',').map(s => s.trim() + 'k');
        const minComm = parseFloat(document.getElementById('commFilter').value);
        const resultDiv = document.getElementById('result');

        if (!fileInput.files[0]) {
            alert("Vui l√≤ng ch·ªçn t·ªáp CSV!");
            return;
        }

        const reader = new FileReader();
        reader.onload = function(e) {
            const text = e.target.result;
            const lines = text.split('\n');
            let filteredHtml = "<strong>K·∫æT QU·∫¢ L·ªåC:</strong>\n\n";
            let count = 0;

            // Gi·∫£ ƒë·ªãnh c·∫•u tr√∫c CSV: T√™n, Link, S·ªë b√°n, Hoa h·ªìng
            // B·∫°n c·∫ßn ƒëi·ªÅu ch·ªânh ch·ªâ s·ªë c·ªôt [2], [3] t√πy theo file c·ªßa b·∫°n
            lines.forEach((line, index) => {
                const cols = line.split(',');
                if (index > 0 && cols.length > 1) {
                    const sales = cols[2] ? cols[2].trim() : ""; // C·ªôt s·ªë b√°n
                    const comm = cols[3] ? parseFloat(cols[3]) : 0; // C·ªôt hoa h·ªìng

                    if (salesTarget.includes(sales) && comm >= minComm) {
                        filteredHtml += `‚úÖ ${cols[0]} | B√°n: ${sales} | HH: ${comm}%\nüîó Link: ${cols[1]}\n---\n`;
                        count++;
                    }
                }
            });

            resultDiv.style.display = "block";
            resultDiv.innerHTML = count > 0 ? filteredHtml : "Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m n√†o kh·ªõp v·ªõi ti√™u ch√≠.";
        };
        reader.readAsText(fileInput.files[0]);
    }
</script>

</body>
</html>